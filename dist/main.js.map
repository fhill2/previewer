{"version":3,"file":"main.js","mappings":"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AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,iBAAiB;AACrC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;AC3LA,gBAAgB,0GAA4C;;AAE5D,IAAI,4CAAY;AAChB;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,EAAE;AACF;;;;;;;;;;AC3BA,cAAc,iEAA8B;AAC5C,kBAAkB,qEAAkC;;AAEpD;AACA;AACA,oPAAoP,kBAAkB;AACtQ;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,sBAAsB;AAClE,4CAA4C,oBAAoB;AAChE;AACA,6BAA6B,iBAAiB;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA,CAAC;;;;;;;;;;;;ACxCD;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;ACAA;;;;;;;;;;;;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC5BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;WCNA;WACA;WACA;WACA;WACA;;;;;WCJA;;;;;UEAA;UACA;UACA;UACA","sources":["webpack:///./src/main/main.js","webpack:///./src/main/util.js","webpack:///./src/main/pipe.js","webpack:///./src/main/i3wm.py","webpack:///./node_modules/mime-db/index.js","webpack:///./node_modules/mime-types/index.js","webpack:///./node_modules/node-ffprobe/index.js","webpack:///./node_modules/node-ffprobe/lib/ffprobe.js","webpack:///external node-commonjs \"child_process\"","webpack:///external node-commonjs \"electron\"","webpack:///external node-commonjs \"fs\"","webpack:///external node-commonjs \"os\"","webpack:///external node-commonjs \"path\"","webpack:///external node-commonjs \"url\"","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///webpack/runtime/node module decorator","webpack:///webpack/runtime/publicPath","webpack:///webpack/before-startup","webpack:///webpack/startup","webpack:///webpack/after-startup"],"sourcesContent":["\nconsole.log(`Hello from Electron ðŸ‘‹`);\nrequire('file-loader?name=[name].[ext]!./pipe.js')\nrequire('file-loader?name=[name].[ext]!./i3wm.py')\n\nimport { app, BrowserWindow, protocol } from \"electron\";\nimport { resolveHtmlPath } from \"./util\";\n\n\nimport path from 'path';\nimport os from 'os';\nimport mime from 'mime-types';\nimport fs from 'fs';\nimport child_process from 'child_process';\n\n// for resizing electron window to video dimensions\nimport probe from 'node-ffprobe';\n\n// ~/.config/previewer\nconst configDir = app.getPath('appData');\nconst config = JSON.parse(\n  fs.readFileSync(path.join(configDir, 'previewer', 'conf.json'))\n);\n\n\nvar PREV_STATE = true;\nvar statusHeight = 25;\n\nfunction i3wm(actions) {\n  // move previewer to 0 0 of the current monitor its on\n  try {\n    // let childFile =\n      // process.env.NODE_ENV == 'production'\n        // ? 'i3wm.py'\n        // : path.join(__dirname, 'i3wm.py');\n    const output = child_process.execSync(\n      'python i3wm.py '  + actions\n    );\n    if (output) console.log(`i3-ipc Output: ${output}`);\n  } catch (error) {\n    console.error(`i3-ipc Error: ${error}`);\n  }\n}\n\nfunction notifySend(msg) {\n  try {\n    const output = child_process.execSync('notify-send ' + msg);\n  } catch (error) {\n    console.error(`i3-ipc Error: ${error}`);\n  }\n}\n\nfunction getScreenWH() {\n  // get the current screen the electron application is on\n  const currentScreen = screen.getDisplayNearestPoint(\n    screen.getCursorScreenPoint()\n  );\n  return [currentScreen.workAreaSize.width, currentScreen.workAreaSize.height];\n}\n\nfunction limitImageVideoSize(width, height) {\n  // limits the size of the preview window when auto scaling videos and images\n  // if previewer width is more than half the width of the currernt screen\n  // scale the previewer window down to half the width of the current screen, maintaining aspect ratio.\n  const [screenW, screenH] = getScreenWH();\n  console.log('before limit: ', screenW, width, height);\n  if (width > screenW / 2) {\n    console.log('larger than half screen');\n    console.log('calculated: ', width, height);\n    let aspect = width / height;\n    width = Math.floor(screenW / 2);\n    height = Math.floor(width / aspect);\n    console.log('new: ', width, height, aspect);\n  }\n\n  console.log('new: ', width, height);\n  return [width, height];\n}\n\nfunction resizeWinToVideo(fp) {\n  probe(fp).then((probeData) => {\n    const [width, height] = limitImageVideoSize(\n      probeData.streams[0].width,\n      probeData.streams[0].height\n    );\n    console.log('setting size: ', width, height);\n    mainWindow.setSize(width, height);\n  });\n}\n\nfunction setSize() {\n  // affects setting size on all previewers\n  // can add global limit functions here. such as keeping the window sm,\n}\n\nfunction mimeToPreviewer(fp) {\n  // decide the previewer to use for the file\n  const mimeType = mime.lookup(fp);\n  if (!mimeType) throw new Error('mimeType not found');\n\n  console.log('main: ', mimeType);\n\n  if (mimeType.startsWith('video')) {\n    resizeWinToVideo(fp);\n    return 'video';\n  }\n\n  if (mimeType.startsWith('audio')) {\n    mainWindow.setSize(500, 100);\n    return 'audio';\n  }\n\n  if (mimeType.startsWith('image')) {\n    resizeWinToVideo(fp);\n    return 'image';\n  }\n\n  if (mimeType == 'application/pdf') {\n    const [screenW, screenH] = getScreenWH();\n    mainWindow.setSize(Math.floor(screenW / 2), screenH - statusHeight);\n    return 'pdf';\n  }\n\n  // if mimeType failed to detect, mimeType=false\n  if (mimeType.startsWith('text')) {\n    // mainWindow.setSize(340, 2400)\n    return 'text';\n  }\n}\n\nconst preview = (fp) => {\n  const filepath = fp.replace(/^~(?=$|\\/|\\\\)/, os.homedir());\n  if (!fs.existsSync(filepath)) {\n    console.log('DOES NOT EXIST - BLOCKING: ' + filepath);\n    return;\n  }\n\n  const stat = fs.statSync(filepath);\n  // if a directory, ignore for now\n  if (stat.isDirectory()) return;\n\n  let previewer;\n  try {\n    previewer = mimeToPreviewer(filepath);\n  } catch (e) {\n    console.log(e);\n    return;\n  }\n  console.log('previewer: ', previewer, filepath);\n  i3wm('move');\n  mainWindow.webContents.send('custom-endpoint', {\n    previewer: previewer,\n    filepath: filepath,\n  });\n};\n\nconst stopPreviewer = () => {\n  PREV_STATE = false;\n  notifySend('Stopping previewer...');\n  i3wm('hide');\n};\n\nconst startPreviewer = () => {\n  PREV_STATE = true;\n  notifySend('Starting previewer...');\n  // i3wm('hide');\n};\n\nconst doAction = (action) => {\n  console.log('action: ', action);\n  switch (action) {\n    case 'toggle':\n      if (PREV_STATE) {\n        stopPreviewer();\n      } else {\n        startPreviewer();\n      }\n      break;\n    case 'exit' || 'quit':\n      app.quit();\n      break;\n    case 'stop':\n      stopPreviewer();\n      break;\n    case 'start':\n      startPreviewer();\n      break;\n    default:\n  }\n};\n\nfunction setupIPC() {\n  // conditional file, otherwise production env does not find the dist file\n  // let childFile =\n  //   process.env.NODE_ENV == 'production'\n  //     ? 'release/app/dist/main/pipe.js'\n  //     : path.join(__dirname, 'pipe.js');\n  const p = child_process.fork(path.join(__dirname, \"pipe.js\"), ['hello'], {\n    stdio: ['pipe', 'pipe', 'pipe', 'ipc'],\n  });\n  // p.stdout.on('data', (d) => {\n  // console.log(\"p.stdout.on: \", d)\n  // });\n  p.stderr.on('data', (d) => {\n    console.log('error: ', d.toString());\n  });\n\n  p.on('message', (m) => {\n    console.log('pipe->main: ', m);\n    let msg = m.replace(/\\n/g, '');\n    msg.includes('/') && PREV_STATE == true ? preview(msg) : doAction(msg);\n  });\n  p.on('exit', (code, sig) => {\n    console.log('exiting child process');\n  });\n}\n\nfunction onRendererMsg(event, channel, res) {\n  console.log(`Received ${channel} message from renderer process`, res);\n  if (res.command == 'resize') {\n      // setting width height in pixels from char count values is bad\n      // instead, set codemirror to autosize width and height, then get the size in pixels of the dom element\n      // then resize electron window with these values\n      // const screenBounds = screen.getDisplayMatching(mainWindow.getBounds()).size;\n      const [screenW, screenH] = getScreenWH();\n\n      let width = Math.round(res.data.width * 9);\n      let maxWidth = Math.round(screenW / 2);\n      if (width > screenW / 2) width = maxWidth;\n\n      // limit to height of screen\n      let height = Math.round(res.data.height * 19); // * to badly convert char count -> pixels until a better implementation\n      if (height > screenH) height = screenH;\n\n      // let appBounds = mainWindow.getBounds();\n      // let maxHeight = screenH - appBounds.y;\n\n      mainWindow.setSize(width, height - statusHeight);\n    }\n}\n\nconst createWindow = () => {\n  let win = new BrowserWindow({\n    width: 800,\n    height: 600,\n    webPreferences: {\n          // if nodeIntegration: false, I have to use a preload script\n          // https://stackoverflow.com/questions/62433323/using-the-electron-ipcrenderer-from-a-front-end-javascript-file\n          nodeIntegration: true, \n          contextIsolation: true, // This must be true\n\n          // worldSafeExecuteJavaScript: true, // This must be true\n          devtools: true,\n    }\n  });\n  win.webContents.openDevTools()\n\n\n  if(app.isPackaged) {\n    win.loadFile('index.html'); // prod\n  }else{\n    win.loadURL('http://localhost:3000'); // dev\n  }\n  // win.loadURL()\n\n  // Add IPC listener on mainWindow instance\n  win.webContents.on('ipc-message', (event, channel, data) => onRendererMsg(event, channel, data));\n  \n  // Remove reference to mainWindow on close\n  win.on('closed', () => {\n    win = null;\n  });\n\n  win.on('ready-to-show', () => {\n    // mainWindow.minimize();\n    // mainWindow.setMenu(null);\n    // mainWindow.show();\n    setupIPC();\n  });\n};\n\napp.whenReady().then(() => {\n  createWindow();\n    protocol.registerFileProtocol('file', (request, callback) => {\n       const url = request.url.substr(7);\n       callback({ path: url });\n     });\n}).catch(console.error)\n  // .then(() => {\n   // })\n\n\n","import { URL } from 'url';\nimport path from 'path';\n\nexport function resolveHtmlPath(htmlFileName) {\n  if (process.env.NODE_ENV === 'development') {\n    const port = process.env.PORT || 1212;\n    const url = new URL(`http://localhost:${port}`);\n    url.pathname = htmlFileName;\n    return url.href;\n  }\n  return `file://${path.resolve(__dirname, '../renderer/', htmlFileName)}`;\n}\n","export default __webpack_public_path__ + \"pipe.js\";","export default __webpack_public_path__ + \"i3wm.py\";","/*!\n * mime-db\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015-2022 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n/**\n * Module exports.\n */\n\nmodule.exports = require('./db.json')\n","/*!\n * mime-types\n * Copyright(c) 2014 Jonathan Ong\n * Copyright(c) 2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\n'use strict'\n\n/**\n * Module dependencies.\n * @private\n */\n\nvar db = require('mime-db')\nvar extname = require('path').extname\n\n/**\n * Module variables.\n * @private\n */\n\nvar EXTRACT_TYPE_REGEXP = /^\\s*([^;\\s]*)(?:;|\\s|$)/\nvar TEXT_TYPE_REGEXP = /^text\\//i\n\n/**\n * Module exports.\n * @public\n */\n\nexports.charset = charset\nexports.charsets = { lookup: charset }\nexports.contentType = contentType\nexports.extension = extension\nexports.extensions = Object.create(null)\nexports.lookup = lookup\nexports.types = Object.create(null)\n\n// Populate the extensions/types maps\npopulateMaps(exports.extensions, exports.types)\n\n/**\n * Get the default charset for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction charset (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n  var mime = match && db[match[1].toLowerCase()]\n\n  if (mime && mime.charset) {\n    return mime.charset\n  }\n\n  // default text/* to utf-8\n  if (match && TEXT_TYPE_REGEXP.test(match[1])) {\n    return 'UTF-8'\n  }\n\n  return false\n}\n\n/**\n * Create a full Content-Type header given a MIME type or extension.\n *\n * @param {string} str\n * @return {boolean|string}\n */\n\nfunction contentType (str) {\n  // TODO: should this even be in this module?\n  if (!str || typeof str !== 'string') {\n    return false\n  }\n\n  var mime = str.indexOf('/') === -1\n    ? exports.lookup(str)\n    : str\n\n  if (!mime) {\n    return false\n  }\n\n  // TODO: use content-type or other module\n  if (mime.indexOf('charset') === -1) {\n    var charset = exports.charset(mime)\n    if (charset) mime += '; charset=' + charset.toLowerCase()\n  }\n\n  return mime\n}\n\n/**\n * Get the default extension for a MIME type.\n *\n * @param {string} type\n * @return {boolean|string}\n */\n\nfunction extension (type) {\n  if (!type || typeof type !== 'string') {\n    return false\n  }\n\n  // TODO: use media-typer\n  var match = EXTRACT_TYPE_REGEXP.exec(type)\n\n  // get extensions\n  var exts = match && exports.extensions[match[1].toLowerCase()]\n\n  if (!exts || !exts.length) {\n    return false\n  }\n\n  return exts[0]\n}\n\n/**\n * Lookup the MIME type for a file path/extension.\n *\n * @param {string} path\n * @return {boolean|string}\n */\n\nfunction lookup (path) {\n  if (!path || typeof path !== 'string') {\n    return false\n  }\n\n  // get the extension (\"ext\" or \".ext\" or full path)\n  var extension = extname('x.' + path)\n    .toLowerCase()\n    .substr(1)\n\n  if (!extension) {\n    return false\n  }\n\n  return exports.types[extension] || false\n}\n\n/**\n * Populate the extensions and types maps.\n * @private\n */\n\nfunction populateMaps (extensions, types) {\n  // source preference (least -> most)\n  var preference = ['nginx', 'apache', undefined, 'iana']\n\n  Object.keys(db).forEach(function forEachMimeType (type) {\n    var mime = db[type]\n    var exts = mime.extensions\n\n    if (!exts || !exts.length) {\n      return\n    }\n\n    // mime -> extensions\n    extensions[type] = exts\n\n    // extension -> mime\n    for (var i = 0; i < exts.length; i++) {\n      var extension = exts[i]\n\n      if (types[extension]) {\n        var from = preference.indexOf(db[types[extension]].source)\n        var to = preference.indexOf(mime.source)\n\n        if (types[extension] !== 'application/octet-stream' &&\n          (from > to || (from === to && types[extension].substr(0, 12) === 'application/'))) {\n          // skip the remapping\n          continue\n        }\n      }\n\n      // set the extension -> mime\n      types[extension] = type\n    }\n  })\n}\n","const ffprobe = module.exports = require('./lib/ffprobe.js')\n\nif (require.main === module) {\n\tconst exit = function (code, msg) {\n\t\tprocess.nextTick(() => process.exit(code))\n\n\t\tif (code !== 0) console.error(msg)\n\t\telse console.log(msg)\n\t}\n\n\tconst args = process.argv.slice(2)\n\n\tif (args.length === 0)\n\t\treturn exit(1, \"Usage: node index.js /path/to/audio/file.mp3\");\n\n\t!async function probeFile(file) {\n\t\tif (!file) return exit(0, 'Finished probing all files')\n\t\ttry {\n\t\t\tconst results = await ffprobe(file)\n\t\t\t\n\t\t\tconsole.log('%s\\n========================================\\n%s\\n\\n', file, JSON.stringify(results, null, '   '))\n\t\n\t\t\tprobeFile(args.shift())\n\t\t} catch(err) {\n\t\t\tconsole.log(err)\n\t\t}\n\t}(args.shift())\n}","const spawn = require('child_process').spawn\nconst spawnSync = require('child_process').spawnSync\n\nmodule.exports = (function () {\n\tfunction doProbeSync(file) {\n\t\tlet proc = spawnSync(module.exports.FFPROBE_PATH || 'ffprobe', ['-hide_banner', '-loglevel', 'fatal', '-show_error', '-show_format', '-show_streams', '-show_programs', '-show_chapters', '-show_private_data', '-print_format', 'json', file], { encoding: 'utf8' })\n\t\tlet probeData = []\n\t\tlet errData = []\n\t\tlet exitCode = null\n\n\t\tprobeData.push(proc.stdout)\n\t\terrData.push(proc.stderr)\n\n\t\texitCode = proc.status\n\n\t\tif (proc.error) throw new Error(proc.error)\n\t\tif (exitCode) throw new Error(errData.join(''))\n\n\t\treturn JSON.parse(probeData.join(''))\n\t}\n\n\tfunction doProbe(file) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tlet proc = spawn(module.exports.FFPROBE_PATH || 'ffprobe', ['-hide_banner', '-loglevel', 'fatal', '-show_error', '-show_format', '-show_streams', '-show_programs', '-show_chapters', '-show_private_data', '-print_format', 'json', file])\n\t\t\tlet probeData = []\n\t\t\tlet errData = []\n\t\n\t\t\tproc.stdout.setEncoding('utf8')\n\t\t\tproc.stderr.setEncoding('utf8')\n\t\n\t\t\tproc.stdout.on('data', function (data) { probeData.push(data) })\n\t\t\tproc.stderr.on('data', function (data) { errData.push(data) })\n\t\n\t\t\tproc.on('exit', code => { exitCode = code })\n\t\t\tproc.on('error', err => reject(err))\n\t\t\tproc.on('close', () => resolve(JSON.parse(probeData.join(''))))\n\t\t})\n\t}\n\n\treturn module.exports.SYNC ? doProbeSync : doProbe\n})()\n","module.exports = require(\"child_process\");","module.exports = require(\"electron\");","module.exports = require(\"fs\");","module.exports = require(\"os\");","module.exports = require(\"path\");","module.exports = require(\"url\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\tloaded: false,\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Flag the module as loaded\n\tmodule.loaded = true;\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the module cache\n__webpack_require__.c = __webpack_module_cache__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.nmd = (module) => {\n\tmodule.paths = [];\n\tif (!module.children) module.children = [];\n\treturn module;\n};","__webpack_require__.p = \"\";","","// module cache are used so entry inlining is disabled\n// startup\n// Load entry module and return exports\nvar __webpack_exports__ = __webpack_require__(__webpack_require__.s = \"./src/main/main.js\");\n",""],"names":["console","log","require","app","BrowserWindow","protocol","resolveHtmlPath","path","os","mime","fs","child_process","probe","configDir","getPath","config","JSON","parse","readFileSync","join","PREV_STATE","statusHeight","i3wm","actions","output","execSync","concat","error","notifySend","msg","getScreenWH","currentScreen","screen","getDisplayNearestPoint","getCursorScreenPoint","workAreaSize","width","height","limitImageVideoSize","_getScreenWH","_getScreenWH2","_slicedToArray","screenW","screenH","aspect","Math","floor","resizeWinToVideo","fp","then","probeData","_limitImageVideoSize","streams","_limitImageVideoSize2","mainWindow","setSize","mimeToPreviewer","mimeType","lookup","Error","startsWith","_getScreenWH3","_getScreenWH4","preview","filepath","replace","homedir","existsSync","stat","statSync","isDirectory","previewer","e","webContents","send","stopPreviewer","startPreviewer","doAction","action","quit","setupIPC","p","fork","__dirname","stdio","stderr","on","d","toString","m","includes","code","sig","onRendererMsg","event","channel","res","command","_getScreenWH5","_getScreenWH6","round","data","maxWidth","createWindow","win","webPreferences","nodeIntegration","contextIsolation","devtools","openDevTools","isPackaged","loadFile","loadURL","whenReady","registerFileProtocol","request","callback","url","substr","URL","htmlFileName","process","env","NODE_ENV","port","PORT","pathname","href","resolve"],"sourceRoot":""}